!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("goat",[],t):"object"==typeof exports?exports.goat=t():e.goat=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=/^\s*([!\w\.]+)\s*([^\w\s|&]{1,3})?\s*([^\sˆ&|\\=)]+)?\s*$/,s=/([&|]{2})|([\(\)])|([!\w\.]+)\s*([^\w\s|&]{1,3})?\s*([^\sˆ&|\)]+)?/g,u=/^['"](.*)['"]$/,a=/^\s*([!]+)\s*(\w+)\s*$/,c=["true","false"];t.Goat=function(){function e(t,n){r(this,e),this._expression=t,this._controller=n}return i(e,[{key:"fields",get:function(){return this._fields}}]),i(e,[{key:"_getRegexMatchArray",value:function(e,t){var n=e.exec(t);if(n)return n=n.filter(function(e){return void 0!==e}),n.shift(),n}},{key:"_evaluateNot",value:function(e,t){var n=void 0;return e.shift(),e.length&&(n=this._evaluateNot(e,t)),this._getOperation("!",n||this._getValue(t))}},{key:"_setField",value:function(e){this._fields||(this._fields=[]),"string"==typeof e&&this.fields.push(e)}},{key:"_getValue",value:function(e){var t=void 0;if(t=this._getRegexMatchArray(a,e)){var n=t[0].split("");return this._evaluateNot(n,t[1])}return c.indexOf(e)>-1?"true"===e:e in this._controller?(this._setField(e),this._getPropertyEval(this._controller,e)):isNaN(e)?(t=u.exec(e))?t[1]:e:parseInt(e)}},{key:"_getPropertyEval",value:function(e,t){return function(){return e[t]}}},{key:"_asFunction",value:function(e){return"function"==typeof e?e():e}},{key:"_getOperation",value:function(e,t,n){var r=this;switch(e){case"==":return function(){return r._asFunction(t)==r._asFunction(n)};case"!=":return function(){return r._asFunction(t)!=r._asFunction(n)};case"===":return function(){return r._asFunction(t)===r._asFunction(n)};case"!==":return function(){return r._asFunction(t)!==r._asFunction(n)};case"<=":case"=<":return function(){return r._asFunction(t)<=r._asFunction(n)};case">=":case"=<":return function(){return r._asFunction(t)>=r._asFunction(n)};case"<":return function(){return r._asFunction(t)<r._asFunction(n)};case">":return function(){return r._asFunction(t)>r._asFunction(n)};case"!":return function(){return!r._asFunction(t)};case"&&":return function(){return r._asFunction(t)&&r._asFunction(n)};case"||":return function(){return r._asFunction(t)||r._asFunction(n)}}}},{key:"_processExpression",value:function(e){var t=void 0;if(e instanceof Array||(e=[e]),1===e.length&&(t=this._getRegexMatchArray(o,e[0]))){var n=this._getValue(t[0]),r=this._getValue(t[2]),i=t[1];e[0]="function"!=typeof n||r||i?this._getOperation(t[1],n,r):n}for(;e.length>1||"function"!=typeof e[0];){var s=-1,u=0,a=0,c=void 0,f=void 0,l=e,_=e.lastIndexOf("(");if(_>-1){l=l.slice(_+1,l.length);var p=l.indexOf(")");l=l.slice(0,p);var h=l.length;e[_]=this._processExpression(l),e.splice(_+1,h+1)}else if((s=e.indexOf("&&"))>-1&&")"!==e[u=s-1]&&"("!==e[a=s+1])c=this._processExpression(e[u]),f=this._processExpression(e[a]),e[u]=this._getOperation("&&",c,f),e.splice(s,2);else{if(!((s=e.indexOf("||"))>-1&&")"!==e[u=s-1]&&"("!==e[a=s+1]))break;c=this._processExpression(e[u]),f=this._processExpression(e[a]),e[u]=this._getOperation("||",c,f),e.splice(s,2)}}if(1===e.length)return e[0]}},{key:"_buildEvaluator",value:function(){var e=this._expression.match(s);return s.lastIndex=0,this._processExpression(e)}},{key:"evaluate",value:function(){return this._evaluator||(this._evaluator=this._buildEvaluator()),this._evaluator()}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);Object.defineProperty(t,"Goat",{enumerable:!0,get:function(){return r.Goat}})}])});